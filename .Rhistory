left_join(dist_cords, by = c("To" = "Districts")) %>%
rename(tolong = X, tolat = Y)
from_Study
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("From" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("To" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(From %in% Study_districts)
from_Study
fromlong[21]
dist32 <- c(long = -80.27990, lat = 25.77110)
dist32
dist32[long]
dist32[,long]
dist32[long]
dist32[1]
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
from_Study
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("From" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("To" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(From %in% Study_districts)
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
# Generate desire lines
from_flows <- gcIntermediate(
p1 = select(from_Study, fromlong:fromlat),
p2 = select(from_Study, tolong:tolat),
sp = TRUE,
addStartEnd = TRUE
)
from_flows <- SpatialLinesDataFrame(from_flows, from_Study)
from_Study
study_ctpp_flows <- ctpp_flows %>% mutate(
study_Os = ifelse (From %in% Study_districts,
min(Study_districts), From
),
study_Ds = ifelse (To %in% Study_districts,
min(Study_districts), To
)
)
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(From, To) %>%
summarise(transit = sum(Trips)) %>%
select(From, To, transit) %>%
filter(From != 0, To != 0)
trips_by_OD
max(trips_by_OD$From)
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(study_Os, study_Ds) %>%
summarise(transit = sum(Trips)) %>%
select(study_Ds, study_Ds, transit) %>%
filter(study_Ds != 0, study_Ds != 0)
study_ctpp_flows
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(study_Os, study_Ds) %>%
summarise(transit = sum(Trips)) %>%
select(study_Ds, study_Ds, transit) %>%
filter(study_Ds != 0, study_Ds != 0)
View(study_ctpp_flows)
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(study_Os, study_Ds) %>%
summarise(transit = sum(Trips)) %>%
select(study_Os, study_Ds, transit) %>%
filter(study_Os != 0, study_Ds != 0)
trips_by_OD
max(trips_by_OD$study_Os)
dist32 <- c(long = -80.27990, lat = 25.77110)
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("From" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("To" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(From %in% Study_districts)
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(From %in% Study_districts)
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(study_Os == 20)
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y)
from_Study
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(study_Os == 20)
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
# Generate desire lines
from_flows <- gcIntermediate(
p1 = select(from_Study, fromlong:fromlat),
p2 = select(from_Study, tolong:tolat),
sp = TRUE,
addStartEnd = TRUE
)
from_flows <- SpatialLinesDataFrame(from_flows, from_Study)
from_Study
from_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(study_Os == 20) %>%
ungroup()
from_Study <- from_Study %>% mutate(fromlong = dist32[1], fromlat = dist32[2])
# Generate desire lines
from_flows <- gcIntermediate(
p1 = select(from_Study, fromlong:fromlat),
p2 = select(from_Study, tolong:tolat),
sp = TRUE,
addStartEnd = TRUE
)
from_flows <- SpatialLinesDataFrame(from_flows, from_Study)
to_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(study_Ds == 20)
to_Study
to_Study <- to_Study %>% mutate(tolong = dist32[1], tolat = dist32[2])
to_flows <- gcIntermediate(
p1 = select(to_Study, fromlong:fromlat),
p2 = select(to_Study, tolong:tolat),
sp = TRUE,
addStartEnd = TRUE
)
to_Study <- trips_by_OD %>%
left_join(dist_cords, by = c("study_Os" = "Districts")) %>%
rename(fromlong = X, fromlat = Y) %>%
left_join(dist_cords, by = c("study_Ds" = "Districts")) %>%
rename(tolong = X, tolat = Y) %>%
filter(study_Ds == 20) %>%
ungroup()
to_Study
to_Study <- to_Study %>% mutate(tolong = dist32[1], tolat = dist32[2])
# Generate desire lines
to_flows <- gcIntermediate(
p1 = select(to_Study, fromlong:fromlat),
p2 = select(to_Study, tolong:tolat),
sp = TRUE,
addStartEnd = TRUE
)
to_flows <- SpatialLinesDataFrame(to_flows, to_Study)
# Map both origins and destination flows to/from study area
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ value/ 10000,
color = "red",
popup = ~paste0("Origins Trips: ", value)
) %>%
addCircleMarkers(
data = from_flows,
lng = from_flows$tolong, lat = from_flows$tolat, weight = 1,
label = ~as.character(format(round(from_flows$value,0), big.mark = ",")),
radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Origins"
) %>%
addPolylines(
data = to_flows,
group = "Destinations",
weight = ~ value/ 10000,
color = "blue",
popup = ~paste0("Destinations Trips: ", value)
) %>%
addCircleMarkers(
data = to_flows,
lng = to_flows$fromlong, lat = to_flows$fromlat, weight = 1,
label =   ~as.character(format(round(to_flows$value,0), big.mark = ",")), radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Destinations"
) %>%
addLayersControl(
baseGroups = c("OSM","Stamen"),
overlayGroups = c("Districts","Origins", "Destinations", "Districts Labels","Flagler Corridor"),
options = layersControlOptions(collapsed = FALSE)
) %>%
hideGroup(c("Districts", "Destinations", "Districts Labels"))
# Map both origins and destination flows to/from study area
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ transit/ 10000,
color = "red",
popup = ~paste0("Origins Trips: ", transit)
) %>%
addCircleMarkers(
data = from_flows,
lng = from_flows$tolong, lat = from_flows$tolat, weight = 1,
label = ~as.character(format(round(from_flows$transit,0), big.mark = ",")),
radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Origins"
) %>%
addPolylines(
data = to_flows,
group = "Destinations",
weight = ~ transit/ 10000,
color = "blue",
popup = ~paste0("Destinations Trips: ", transit)
) %>%
addCircleMarkers(
data = to_flows,
lng = to_flows$fromlong, lat = to_flows$fromlat, weight = 1,
label =   ~as.character(format(round(to_flows$transit,0), big.mark = ",")), radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Destinations"
) %>%
addLayersControl(
baseGroups = c("OSM","Stamen"),
overlayGroups = c("Districts","Origins", "Destinations", "Districts Labels","Flagler Corridor"),
options = layersControlOptions(collapsed = FALSE)
) %>%
hideGroup(c("Districts", "Destinations", "Districts Labels"))
from_flows
# Map both origins and destination flows to/from study area
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ transit,
color = "red",
popup = ~paste0("Origins Trips: ", transit)
) %>%
addCircleMarkers(
data = from_flows,
lng = from_flows$tolong, lat = from_flows$tolat, weight = 1,
label = ~as.character(format(round(from_flows$transit,0), big.mark = ",")),
radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Origins"
) %>%
addPolylines(
data = to_flows,
group = "Destinations",
weight = ~ transit,
color = "blue",
popup = ~paste0("Destinations Trips: ", transit)
) %>%
addCircleMarkers(
data = to_flows,
lng = to_flows$fromlong, lat = to_flows$fromlat, weight = 1,
label =   ~as.character(format(round(to_flows$transit,0), big.mark = ",")), radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Destinations"
) %>%
addLayersControl(
baseGroups = c("OSM","Stamen"),
overlayGroups = c("Districts","Origins", "Destinations", "Districts Labels","Flagler Corridor"),
options = layersControlOptions(collapsed = FALSE)
) %>%
hideGroup(c("Districts", "Destinations", "Districts Labels"))
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ transit/1000,
color = "red",
popup = ~paste0("Origins Trips: ", transit)
)
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ transit/100,
color = "red",
popup = ~paste0("Origins Trips: ", transit)
)
map %>%
addPolylines(
data = from_flows,
group = "Origins",
weight = ~ transit/100,
color = "red",
popup = ~paste0("Origins Trips: ", transit)
) %>%
addCircleMarkers(
data = from_flows,
lng = from_flows$tolong, lat = from_flows$tolat, weight = 1,
label = ~as.character(format(round(from_flows$transit,0), big.mark = ",")),
radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Origins"
) %>%
addPolylines(
data = to_flows,
group = "Destinations",
weight = ~ transit,
color = "blue",
popup = ~paste0("Destinations Trips: ", transit)
) %>%
addCircleMarkers(
data = to_flows,
lng = to_flows$fromlong, lat = to_flows$fromlat, weight = 1,
label =   ~as.character(format(round(to_flows$transit,0), big.mark = ",")), radius = 1,
labelOptions = labelOptions(noHide = T),
group = "Destinations"
) %>%
addLayersControl(
baseGroups = c("OSM","Stamen"),
overlayGroups = c("Districts","Origins", "Destinations", "Districts Labels","Flagler Corridor"),
options = layersControlOptions(collapsed = FALSE)
) %>%
hideGroup(c("Districts", "Destinations", "Districts Labels"))
library(acs)
layerName <- strsplit(strsplit(acs_shapeFile,"[.]")[[1]],"/")[[1]][2]
# Add census shape files
acsShape <- readOGR(paste0(projDir,"/",acs_shapeFile), layer = layerName, verbose = FALSE)
View(ascShape)
View(acsShape)
sum(acsShape$POP2010)
sum(acsShape$Popul)
sum(acsShape$Emp)
install.packages("acs")
?acs.fetch()
library(acs)
api.key.install(key="e2e7a5b05c688346094ae9a76cc92473137f1589")
acs_data <- acs.fetch (geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B05006")
acs_data[1:10,]
acs_data
lots.o.data=acs.fetch(geo=geo.make(state="WA",
county=c(33,35,53,61), tract="*"), table.number="B05006")
acs_data <- acs.fetch (endyear = 2011, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B05006")
dim(acs_data)
head(acs_data)
View(acs_data)
acs_data[,1:10]
acs_data[1:20,1:10]
acs_data[1:20,1]
acs_data[1:20,2]
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202_001E")
dim(acs_data)
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202", col.names = c("B08202_001E" , "B08202_006E", "B08202_009E", "B08202_013E", "B08202_018E"))
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202"
)
head(acs_data)
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202", col.names = c("B08202_001" , "B08202_006", "B08202_009", "B08202_013", "B08202_018"))
acs.lookup(keyword="Income")
acs.lookup(dataset = "acs", endyear = 2014, keyword="Income")
col.names(acs_data)
colnames(acs_data)
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202")
head(acs_data)
acs_data <- acs.fetch (endyear = 2014, geo=geo.make(state="FL", county=c(86), tract="*"),
table.number="B08202", col.names = c("B08202_001" , "B08202_006", "B08202_009", "B08202_013", "B08202_018"))
estimate(acs_data)
x <- estimate(acs_data)
head(x)
apc_dir <- "bus_apc_data/Flagler St BRTStudy APC Data Oct 2015_Xlsx"
xlsFiles <- dir(apc_dir, pattern = ".xlsx")
xlsFiles
apc_data <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
head(apc_data)
unique(apc_data$DAY)
for (i in 1:length(xlsFiles)){
apc_data <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
ifelse(i ==1, apc_data <- apc_data_route, apc_data <- rbind(apc_data,apc_data_route))
}
for (i in 1:length(xlsFiles)){
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
ifelse(i ==1, apc_data <- apc_data_route, apc_data <- rbind(apc_data,apc_data_route))
}
unique(apc_data$ROUTE)
length(unique(apc_data$ROUTE))
xlsFiles
apc_data %>% group_by(ROUTE) %>% summarise(boardings = sum(DAY_TOT))
apc_data %>% group_by(ROUTE) %>% summarise(boardings = sum(DAY_TOT))
for (i in 1:length(xlsFiles)){
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
ifelse(i ==1, apc_data <- apc_data_route, apc_data <- rbind(apc_data,apc_data_route))
}
View(apc_data)
x <- apc_data %>% group_by(ROUTE) %>% summarise(boardings = sum(DAY_TOT))
x
str(apc_data)
x <- apc_data %>% group_by(ROUTE) %>% summarize(boardings = sum(DAY_TOT))
x
x <- apc_data %>% group_by(DIR) %>% summarize(boardings = sum(DAY_TOT))
x
x <- apc_data %>% group_by(ROUTE) %>% summarize(boardings = mean(DAY_TOT))
x
i
x <- apc_data  %>% summarize(boardings = sum(DAY_TOT))
x
x <- apc_data %>% as.data.frame() %>% group_by(ROUTE) %>% summarize(boardings = sum(DAY_TOT))
x
apc_data %>% group_by(ROUTE) %>% summarize(boardings = mean(DAY_TOT))
apc_data %>% group_by(ROUTE) %>% summarize(boardings = sum(DAY_TOT))
apc_data %>% group_by(ROUTE) %>% summarise(boardings = sum(DAY_TOT))
x <- apc_data %>% as.character(ROUTE) %>% group_by(ROUTE) %>% summarize(boardings = sum(DAY_TOT))
col.name(apc_data)
colnames(apc_data)
x <- apc_data %>% group_by(STOP) %>% summarize(boardings = sum(DAY_TOT))
x
View(apc_data)
x <- apc_data_route %>% group_by(STOP) %>% summarize(boardings = sum(DAY_TOT))
x
library(dplyr)
x <- apc_data_route %>% group_by(STOP) %>% summarize(boardings = sum(DAY_TOT))
x
xlsFiles <- dir(apc_dir, pattern = ".xlsx")
for (i in 1:length(xlsFiles)){
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
ifelse(i ==1, apc_data <- apc_data_route, apc_data <- bind_rows(apc_data, apc_data_route))
}
x <- apc_data %>% group_by(STOP) %>% summarize(boardings = sum(DAY_TOT))
x
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(study_Os, study_Ds) %>%
summarise(transit = sum(Trips)) %>%
select(study_Os, study_Ds, transit) %>%
filter(study_Os != 0, study_Ds != 0)
study_ctpp_flows <- ctpp_flows %>% mutate(
study_Os = ifelse (From %in% Study_districts,
min(Study_districts), From
),
study_Ds = ifelse (To %in% Study_districts,
min(Study_districts), To
)
)
# Plot transit desire lines
trips_by_OD <- study_ctpp_flows %>%
filter(modes == "transit") %>%
group_by(study_Os, study_Ds) %>%
summarise(transit = sum(Trips)) %>%
select(study_Os, study_Ds, transit) %>%
filter(study_Os != 0, study_Ds != 0)
apc_data_route
x <- apc_data %>% group_by(STOPNAME) %>% summarize(boardings = sum(DAY_TOT))
x
?read_excel()
tapply(apc_data$DAY_TOT, apc_data$ROUTE, sum)
x <- apc_data %>% group_by(STOPNAME) %>% summarize(avg = sum(DAY_TOT))
x
x <- apc_data %>% group_by("STOPNAME") %>% summarize(avg = sum(DAY_TOT))
x
x <- apc_data %>% as.data.frame() %>% group_by("STOPNAME") %>% summarize(tot = sum(DAY_TOT))
x
View(shape)
shape %>% group_by(PlnArea) %>% summarise(tot = TOTPOP)
shape@data %>% group_by(PlnArea) %>% summarise(tot = TOTPOP)
apc_data <- as.data.frame(apc_data)
x <- apc_data %>% group_by("STOPNAME") %>% summarize(avg = sum(DAY_TOT))
x
x <- apc_data %>% group_by(STOPNAME) %>% summarize(avg = sum(DAY_TOT))
x
x <- apc_data %>% group_by(DIR) %>% summarize(avg = sum(DAY_TOT))
x
group_by()
?group_by()
group_by(apc_data, ROUTE) %>% summarise(total = sum(DAY_TOT))
View(apc_data)
str(apc_data)
colnames(apc_data)
x <- apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(tot = sum(DAY_TOT))
x
x <- apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(samples = n())
x <- apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(sum(DAY_ON))
x
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]))
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]), sheet = 1)
xlsFiles <- dir(apc_dir, pattern = ".xlsx")
for (i in 1:length(xlsFiles)){
apc_data_route <- read_excel(paste0(projDir,"/",apc_dir,"/",xlsFiles[i]), sheet = 1)
ifelse(i ==1, apc_data <- apc_data_route, apc_data <- bind_rows(apc_data, apc_data_route))
}
x <- apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(sum(DAY_ON))
x
apc_data %>% ungroup()
apc_data <- apc_data %>% ungroup()
apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(sum(DAY_ON))
apc_data %>% group_by(apc_data$ROUTE) %>% summarize(sum(DAY_ON))
apc_data %>% group_by(apc_data$STOPNAME) %>% summarize(sum(DAY_ON))
apc_data$ROUTE <- as.character(apc_data$ROUTE)
apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(sum(DAY_ON))
headapc_data)
head(apc_data)
apc_dir
write.csv(apc_data, paste0(apc_dir,"/apc_data.csv"))
apc_data <- read.csv(paste0(apc_dir,"/apc_data.csv"))
x <- apc_data %>% group_by(ROUTE,STOPNAME) %>% summarize(sum(DAY_ON))
x
